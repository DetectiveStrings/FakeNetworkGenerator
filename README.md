# FakeNetworkGenerator
Fake network generator tool, that I developed to create a CTF challenge, but this is the time to share the knowledge , however, you can use it to perform real attacks in your red teaming engagement (currently it's low impact ,but the library still in progress )

This lib is mainlly written to generate network trrafic(using virtual interface , or using wlan interface and interact with the environment) with any scenario so the person can analyse and learn the skill that he wants to. 

I'll be happy if anyone wants to add more features or edit anyone to improve the performance

## About Liberary Files  
This lib is consents of 3 files. 

lafng.py        : The main lib you can use.

Custom_lafng.py : This file is used by lafng to produce custom protocols and custom requests to specific network layers.

Freq_use.py     : Contains ferquantlly used functions and data structures also used by lafng and Custom_lafng.

# lafng

This is the main part and contains all the functions you need to generate fake network traffic and attack traffics.

If you use it on your public network interface make sure to run your script as root. 

## Import 
```python 

import lafng as La

```

## Important Data 

1) MacTable       : Contains all the mac addresses that are randomly generated to the fake network based on the IP range. (generated by ffunction )
2) IpTable        : Contains all the Ip addresses for the fake network based on the IP range. (generated by function )
3) ThisInterFace  : contains the Network interface data . (set from function)
4) OurServerData  : select random ip and mac from (MacTable , IpTable ) to be the internal server network information.

## Functions 
### SetUP

1) RandomStringGenrator : Genetras a random string. (not for user usage)
2) HttpPathGenerator    : Genetras a random http path using RandomStringGenrator. (not for user usage)

### TCP

Almost any traffic generated by this section will be marked as malformed because the sequence bytes will be overwritten and will not be as you want, this problem will be solved using the custom version of the TCP protocol (i will try to add it ASAP).

#### TcpSyn : Genetras a Tcp Syn packet.

Parameters  : SrcIp , DstIp .

Retuen : SrcPort  , DstPort , PacSequ (syn packet sequence)

usage 

```python 
La.TcpSyn('192.168.1.53' , '192.168.1.88' )
```

or

```python 
La.TcpSyn(La.random.choice(La.IpTable) , La.random.choice(La.IpTable) )
```

#### TcpPushAck : Generats PushAck packet . 

Parameters  : SrcIp , DstIp , SrcPort , DstPort , PacSequ (syn packet sequence ) ( optional parameters) 

Return      : PacSequ 

usage 

```python 
La.TcpPushAck('192.168.1.53' , '8.8.8.98' , 66 , 532 , 176632 )
```

or

```python 
La.TcpPushAck(La.random.choice(La.IpTable) , La.random.choice(La.IpTable) , La.random.randint(1 , 65000), La.random.randint(1 , 65000) , La.random.randint(1, 10000000))
```

#### TcpCooker : Generats Any type of tcp paackets . 

Parameters  : SrcIp , DstIp , SrcPort , DstPort , flag(the type of tcp packet ) , PacSequ (syn packet sequence ) ( optional parameters) 

Return      : PacSequ 

usage 

```python 
La.TcpCooker('8.8.8.8' , '1.2.3.4' , 23534 , 3214 , 'FA' )
```

or

```python 
La.TcpCooker(La.random.choice(La.IpTable) , La.random.choice(La.IpTable)  ,  La.random.randint(1 , 65000), La.random.randint(1 , 65000) , 'PS' )
```

#### BasicTcp : generats  a basic tcp stream of (syn , ?SYNACK , PUSH , PUSHACK , FIN , FINACK) using  TcpCooker and TcpSyn finctions 

Parameters : SrcIp , DstIp 

Return : No return 

```python 
La.BasicTcp('10.15.20.25' , '25.20.15.25')
```

or

```python 
La.BasicTcp(La.random.choice(La.IpTable) , La.random.choice(La.IpTable)  ,  La.random.randint(1 , 65000), La.random.randint(1 , 65000) , 'PS' )
```

### HTTP

Generates fake HTTP requests and response.

#### httpRequets : engerats Fake http request 

Parameters :
